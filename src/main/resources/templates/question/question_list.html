<html layout:decorate="~{layout}">
<div class="container my-3" layout:fragment="content" th:if="${paging != null}">
  <table class="table">
    <thead class="table-dark">
    <tr class="text-center">
      <th>번호</th>
      <th style="width:50%">제목</th>
      <th>글쓴이</th>
      <th>작성일시</th>
    </tr>
    </thead>

    <tbody>
    <tr class="text-center" th:each="question, loop : ${paging}">
      <td th:text="${paging.getTotalElements - (paging.number * paging.size) - loop.index}"></td>
      <!--          ${paging.getTotalElements - (paging.number * paging.size) - loop.index}: 전체 질문 수 - (현재 페이지 번호 * 페이지 당 질문 수) - 현재 루프의 인덱스-->
      <td class="text-start">
        <a th:href="@{|/question/detail/${question.id}|}" th:text="${question.subject}"></a>
        <span class="text-danger small ms-2"
              th:if="${#lists.size(question.answerList) > 0}"
              th:text="${#lists.size(question.answerList)}">
      </span>
      </td>
      <td>
        <span th:if="${question.author != null}" th:text="${question.author.username}"></span>
      </td>
      <td th:text="${#temporals.format(question.createDate, 'yyyy-MM-dd HH:mm')}"></td>
    </tr>
    </tbody>
  </table>

  <nav aria-label="Page navigation" class="d-flex justify-content-center" th:if="${!paging.isEmpty()}"
       th:with="queryStrBase = '?kw' + ${param.kw != null ? param.kw : ''}">
    <ul class="pagination">
      <li class="page-item" th:classappend="${!paging.hasPrevious} ? 'disabled' : null">
        <a aria-label="Prev" class="page-link" th:href="@{|${queryStrBase}&page=${paging.number-1}|}">이전</a>
      </li>
      <li class="page-item" th:classappend="${page == paging.number} ? 'active' : null"
          th:each="page : ${#numbers.sequence(0, paging.totalPages-1)}"
          th:if="${page >= paging.number-3 and page <= paging.number+3}">
        <a class="page-link" th:href="@{|/question/list?page=${page}|}" th:text="${page + 1}"></a>
        <!--            #numbers.sequence(0, paging.totalPages-1): 0부터 totalPages-1까지의 숫자 시퀀스를 생성-->
      </li>
      <li class="page-item" th:classappend="${!paging.hasNext} ? 'disabled' : null">
        <a aria-label="Next" class="page-link" th:href="@{|${queryStrBase}&page=${paging.number + 1}|}">다음</a>
      </li>
    </ul>
  </nav>

  <div class="row mb-3">
    <div class="col-6">
      <a class="btn btn-primary" th:href="@{/question/create}">질문 등록하기</a>
    </div>
    <div class="col-6">
      <form th:action="@{/question/list}" method="get">
      <div class="input-group">
        <input class="form-control" id="search_kw" name="kw" th:value="${param.kw}" type="text">
        <button class="btn btn-outline-secondary" type="submit">찾기</button>
      </div>
    </form>
    </div>
  </div>
</div>


</html>
<!--
  여기서 추가한 loop 객체를 이용하여 루프 내에서 다음과 같은 속성들을 사용할 수 있습니다:

    순서 관련 속성
    loop.index: 루프의 순서 (0부터 1씩 증가)
    loop.count: 루프의 순서 (1부터 1씩 증가)

    크기 관련 속성
    loop.size: 반복 객체의 요소 개수 (예: questionList의 요소 개수)

    위치 판별 속성
    loop.first: 루프의 첫 번째 순서인 경우 true
    loop.last: 루프의 마지막 순서인 경우 true

    홀짝 판별 속성
    loop.odd: 루프의 홀수 번째 순서인 경우 true
    loop.even: 루프의 짝수 번째 순서인 경우 true

    현재 객체
    loop.current: 현재 대입된 객체 (여기서는 q과 동일)
-->
<!-- 루프 사용 예시 -->
<!--<div th:each="question, loop : ${questionList}">-->
<!--  <p>순번 (0부터): <span th:text="${loop.index}"></span></p>-->
<!--  <p>순번 (1부터): <span th:text="${loop.count}"></span></p>-->
<!--  <p>전체 개수: <span th:text="${loop.size}"></span></p>-->
<!--  <p>첫 번째?: <span th:text="${loop.first}"></span></p>-->
<!--  <p>마지막?: <span th:text="${loop.last}"></span></p>-->
<!--  <p>홀수 번째?: <span th:text="${loop.odd}"></span></p>-->
<!--  <p>짝수 번째?: <span th:text="${loop.even}"></span></p>-->
<!--  <p>질문 내용: <span th:text="${question.content}"></span></p>-->
<!--</div>-->

<!--
  loop.index는 배열이나 리스트의 인덱스로 활용 가능
  loop.first와 loop.last는 첫 번째/마지막 요소에 특별한 스타일 적용 시 유용
  loop.odd와 loop.even은 테이블의 행 색상을 번갈아 표시할 때 활용
-->

